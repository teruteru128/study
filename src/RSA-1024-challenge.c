
#include <stdio.h>
#include <gmp.h>

#define N "135066410865995223349603216278805969938881475605667027524485143851526510604859533833940287150571909441798207282164471551373680419703964191743046496589274256239341020864383202110372958725762358509643110564073501508187510676594629205563685529475213500852879416377328533906109750544334999811150056977236890927563"
#define BASE 10

/*
RSA-1024-challenge
135066410865995223349603216278805969938881475605667027524485143851526510604859533833940287150571909441798207282164471551373680419703964191743046496589274256239341020864383202110372958725762358509643110564073501508187510676594629205563685529475213500852879416377328533906109750544334999811150056977236890927563
*/
int main(int argc, char* argv[]){
  mpz_t n;
  mpz_t p;
  mpz_t q;
  mpz_t sqQ;
  mpz_t doubledSqQ;
  mpz_t psubq;
  mpz_t num;
  mpz_inits(n, p, q, sqQ, doubledSqQ, psubq, num, NULL);
  mpz_set_str(n, N, BASE);
  // qを1からsqrt(n)までループ, (n-q^2)/qがqより大きくなるまでループ
  int i=0;
  mpz_setbit(num, 511);
  for(;;i++){
    mpz_set(q, num);
    mpz_setbit(q, i);
    mpz_mul(sqQ, q, q);
    if(mpz_cmp(sqQ, n) > 0){
      break;
    }
    mpz_mul_si(doubledSqQ, sqQ, 2);
    if(mpz_cmp(n, sqQ) > 0 && mpz_cmp(n, doubledSqQ) < 0){
      gmp_printf("%Zd, %Zx\n", q, q);
    }
  }
}

